# C// compiler
The compiler was created for educational purposes using Java, ANTLR and LLVM.
The target language is a simplified version of the C language with some
modifications. The double slash in its name implies that a number of features
were sliced off the C language.

A source C// file is compiled to the LLVM language and the clang compiler is used
to generate the final executable.

## Repository structure
```bash
.
├── demos
│   ├── format.ll
│   ├── max
│   │   ├── Makefile
│   │   └── max.css
│   ├── paths
│   │   ├── input.txt
│   │   ├── Makefile
│   │   ├── paths.c
│   │   └── paths.css
│   └── strings
│       ├── input.txt
│       ├── libstring.css
│       ├── Makefile
│       ├── strings.c
│       └── strings.css
├── pom.xml
├── README.md
└── src
    └── main
        ├── java
        │   └── org
        │       └── compiler
        │           ├── Expression.java
        │           ├── ExpressionVisitor.java
        │           ├── FuncParamListVisitor.java
        │           ├── FunctionArgumentListVisitor.java
        │           ├── FunctionArgumentVisitor.java
        │           ├── Function.java
        │           ├── GlobalContext.java
        │           ├── Main.java
        │           ├── MainVisitor.java
        │           ├── Pair.java
        │           ├── ScopeInfo.java
        │           ├── Statement.java
        │           ├── StatementVisitor.java
        │           ├── TypeVisitor.java
        │           ├── VariableExpression.java
        │           ├── VariableExpressionVisitor.java
        │           ├── Variable.java
        │           └── VarType.java
        └── resources
            ├── css.g4
            ├── cssLex.g4
            └── templates.stg
```
Directory `demos` contains subdirectories which illustrate the syntax of the
C// language. File `format.ll` contains declarations of format strings in the
LLVM language.

Directory `src/main/java/org/compiler/` contains the source files of the compiler.
File `Main.java` is the entry point of the compiler.

Directory `src/main/java/org/compiler/gen/` contains the compiler components
generated by ANTLR based on the grammar description.

Directory `src/main/resources/` contains the ANTLR grammar description files as
well as the LLVM language templates.

## Build instructions

### Required packages
* Java 17 SDK
* `make`
* `maven`
* `clang`

### Building the compiler
First, build the compiler by running:
```
mvn clean install
```

### Compiling a C// program
To compile a C// program, invoke the C// compiler by running:
```
mvn exec:java -Dexec.args="<input_file> -o <output_file>"
```
> [!NOTE]
> When compiling the `strings` demo, the `libstring.css` string library
> needs to be built first.

#### Building the string library for the strings demo

To build the string library, run the following command in the project's root
directory:
```
mvn exec:java -Dexec.args="demos/strings/libstring.css -o libstring.ll"
```

### Buidling a demo
To build a demo, first build the LLVM (`.ll`) object from a `.css` file
by running the C// compiler as described above. Then simply run `make`
in the respective directory to build the executable.
